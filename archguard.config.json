{
  "outputDir": "./archguard",
  "format": "mermaid",
  "exclude": [
    "**/*.test.ts",
    "**/*.spec.ts",
    "**/__tests__/**",
    "**/dist/**",
    "**/node_modules/**"
  ],
  "mermaid": {
    "enableLLMGrouping": true,
    "renderer": "isomorphic",
    "theme": "default",
    "transparentBackground": false
  },
  "cli": {
    "command": "claude",
    "args": [],
    "timeout": 300000
  },
  "cache": {
    "enabled": true,
    "ttl": 3600
  },
  "concurrency": 8,
  "verbose": true,
  "metadata": {
    "title": "ArchGuard Architecture Diagrams",
    "description": "展示 ArchGuard TypeScript 架构分析工具的核心架构图",
    "system": "ArchGuard - TypeScript Architecture Diagram Generator",
    "author": "ArchGuard Team",
    "projectUrl": "https://github.com/anthropics/archguard",
    "keywords": ["架构分析", "TypeScript", "Mermaid", "CLI", "AST Parsing"]
  },
  "diagrams": [
    {
      "name": "overview/package",
      "sources": ["./src"],
      "level": "package",
      "description": "Package-level overview of ArchGuard",
      "metadata": {
        "title": "ArchGuard Package Overview",
        "subtitle": "系统架构概览",
        "purpose": "展示 ArchGuard 整体包结构和模块依赖关系",
        "primaryActors": ["开发者", "架构师"],
        "input": {
          "type": "TypeScript 源代码目录",
          "description": "待分析的项目源代码",
          "example": "./src"
        },
        "output": {
          "description": "包级依赖关系图",
          "formats": ["PNG", "SVG", "MMD"],
          "example": "archguard/overview/package.png"
        }
      },
      "design": {
        "architectureStyle": "layered",
        "patterns": [
          {
            "name": "Layered Architecture",
            "category": "structural",
            "participants": ["cli", "parser", "mermaid", "ai", "types", "utils"],
            "description": "三层架构：CLI 层 → 业务逻辑层 → 基础设施层"
          }
        ],
        "principles": [
          "Dependency Inversion - 高层模块不依赖低层模块",
          "Separation of Concerns - 每个包单一职责"
        ]
      },
      "process": {
        "stages": 5,
        "dataFlow": "用户命令 → CLI 处理 → 配置加载 → 文件发现 → 并行解析 → 聚合 → 图生成 → 渲染",
        "keyDependencies": ["commander", "ts-morph", "isomorphic-mermaid", "sharp", "zod"]
      },
      "annotations": {
        "enableComments": true,
        "highlightPatterns": true,
        "includeUsageExample": true
      }
    },
    {
      "name": "class/all-classes",
      "sources": ["./src"],
      "level": "class",
      "description": "Class-level diagram for all modules",
      "metadata": {
        "title": "ArchGuard Complete Class Architecture",
        "subtitle": "完整类图",
        "purpose": "展示所有模块的核心类及其关系",
        "primaryActors": ["开发者", "架构师"],
        "input": {
          "type": "TypeScript 源代码",
          "example": "./src/**/*.ts"
        },
        "output": {
          "description": "完整类图（包含所有模块）",
          "formats": ["PNG", "SVG", "MMD"]
        }
      },
      "annotations": {
        "enableComments": true,
        "highlightPatterns": true
      }
    },
    {
      "name": "method/all-methods",
      "sources": ["./src"],
      "level": "method",
      "description": "Method-level diagram for all modules",
      "metadata": {
        "title": "ArchGuard Method-Level Architecture",
        "subtitle": "方法级架构",
        "purpose": "展示所有类的详细方法签名和属性",
        "primaryActors": ["开发者"],
        "input": {
          "type": "TypeScript 源代码"
        },
        "output": {
          "description": "方法级详细图",
          "formats": ["PNG", "SVG", "MMD"]
        }
      },
      "annotations": {
        "enableComments": true
      }
    },
    {
      "name": "method/cli-module",
      "sources": ["./src/cli"],
      "level": "method",
      "description": "Method-level detail for CLI module",
      "metadata": {
        "title": "CLI Module Method-Level Architecture",
        "subtitle": "CLI 模块方法详解",
        "purpose": "展示 CLI 命令处理、配置加载、进度报告的详细实现",
        "primaryActors": ["开发者"],
        "input": {
          "type": "CLI 命令",
          "example": "archguard analyze -s ./src"
        },
        "output": {
          "description": "CLI 处理流程详细图"
        }
      },
      "design": {
        "patterns": [
          {
            "name": "Command Pattern",
            "category": "behavioral",
            "participants": ["createAnalyzeCommand", "createInitCommand", "createCacheCommand"],
            "description": "每个命令封装为一个独立的命令对象"
          },
          {
            "name": "Builder Pattern",
            "category": "creational",
            "participants": ["ConfigLoader"],
            "description": "分步构建配置"
          },
          {
            "name": "Observer Pattern",
            "category": "behavioral",
            "participants": ["ProgressReporter"],
            "description": "统一的进度报告接口"
          }
        ]
      },
      "process": {
        "dataFlow": "CLI 命令 → Commander 解析 → ConfigLoader → DiagramProcessor → 输出"
      },
      "classes": {
        "highlightClasses": ["ConfigLoader", "DiagramProcessor", "ProgressReporter"],
        "annotateClasses": [
          {
            "className": "ConfigLoader",
            "stereotypes": ["<<Builder>>"],
            "responsibility": "加载并验证配置文件"
          },
          {
            "className": "DiagramProcessor",
            "stereotypes": ["<<Chain of Responsibility>>"],
            "responsibility": "协调整个图表处理流程"
          }
        ]
      },
      "annotations": {
        "enableComments": true,
        "highlightPatterns": true
      }
    },
    {
      "name": "method/mermaid-module",
      "sources": ["./src/mermaid"],
      "level": "method",
      "description": "Method-level detail for Mermaid module",
      "metadata": {
        "title": "Mermaid Module Method-Level Architecture",
        "subtitle": "Mermaid 生成模块方法详解",
        "purpose": "展示 Mermaid 代码生成、验证、渲染的详细实现",
        "primaryActors": ["开发者"],
        "input": {
          "type": "ArchJSON"
        },
        "output": {
          "description": "Mermaid 图表文件",
          "formats": ["PNG", "SVG", "MMD"]
        }
      },
      "design": {
        "patterns": [
          {
            "name": "Pipeline Pattern",
            "category": "behavioral",
            "participants": ["MermaidDiagramGenerator", "ValidatedMermaidGenerator", "MermaidValidationPipeline"],
            "description": "数据处理流水线"
          },
          {
            "name": "Strategy Pattern",
            "category": "behavioral",
            "participants": ["HeuristicGrouper", "LLMGrouper"],
            "description": "多种分组策略"
          },
          {
            "name": "Template Method Pattern",
            "category": "behavioral",
            "participants": ["MermaidValidationPipeline"],
            "description": "定义验证流程"
          }
        ]
      },
      "process": {
        "stages": 5,
        "dataFlow": "ArchJSON → Grouping → Mermaid Code → Validation → Auto-Repair → Rendering"
      },
      "classes": {
        "highlightClasses": ["MermaidDiagramGenerator", "ValidatedMermaidGenerator", "MermaidValidationPipeline", "CommentGenerator"],
        "annotateClasses": [
          {
            "className": "MermaidDiagramGenerator",
            "stereotypes": ["<<Facade>>"],
            "responsibility": "协调整个生成流程"
          },
          {
            "className": "CommentGenerator",
            "stereotypes": ["<<Generator>>"],
            "responsibility": "v2.1.0: 生成元数据注释"
          }
        ]
      },
      "annotations": {
        "enableComments": true,
        "highlightPatterns": true
      }
    },
    {
      "name": "method/parser-module",
      "sources": ["./src/parser"],
      "level": "method",
      "description": "Method-level detail for Parser module",
      "metadata": {
        "title": "Parser Module Method-Level Architecture",
        "subtitle": "解析模块方法详解",
        "purpose": "展示 TypeScript 源代码解析为 ArchJSON 的详细实现",
        "primaryActors": ["开发者"],
        "input": {
          "type": "TypeScript 源文件",
          "example": "./src/**/*.ts"
        },
        "output": {
          "description": "ArchJSON 结构",
          "formats": ["JSON"]
        }
      },
      "design": {
        "patterns": [
          {
            "name": "Strategy Pattern",
            "category": "behavioral",
            "participants": ["ClassExtractor", "MethodExtractor", "RelationExtractor"],
            "description": "不同元素使用不同提取策略"
          },
          {
            "name": "Facade Pattern",
            "category": "structural",
            "participants": ["TypeScriptParser"],
            "description": "简化 ts-morph API"
          }
        ]
      },
      "process": {
        "dataFlow": "TypeScript Code → ts-morph AST → Extractors → ArchJSON"
      },
      "classes": {
        "highlightClasses": ["TypeScriptParser", "ClassExtractor", "MethodExtractor", "RelationExtractor", "ArchJSONAggregator", "ParallelParser"],
        "annotateClasses": [
          {
            "className": "TypeScriptParser",
            "stereotypes": ["<<Facade>>"],
            "responsibility": "解析 TypeScript 源代码"
          },
          {
            "className": "ClassExtractor",
            "stereotypes": ["<<Strategy>>"],
            "responsibility": "提取类型实体"
          },
          {
            "className": "ParallelParser",
            "stereotypes": ["<<Parallel>>"],
            "responsibility": "并发解析多个文件"
          }
        ]
      },
      "annotations": {
        "enableComments": true,
        "highlightPatterns": true
      }
    },
    {
      "name": "method/ai-module",
      "sources": ["./src/ai"],
      "level": "method",
      "description": "Method-level detail for AI module",
      "metadata": {
        "title": "AI Integration Module Method-Level Architecture",
        "subtitle": "AI 集成模块方法详解",
        "purpose": "展示 Claude CLI 集成和 LLM 智能分组的详细实现",
        "primaryActors": ["开发者"],
        "input": {
          "type": "ArchJSON"
        },
        "output": {
          "description": "分组决策"
        }
      },
      "design": {
        "patterns": [
          {
            "name": "Adapter Pattern",
            "category": "structural",
            "participants": ["ClaudeCodeAdapter"],
            "description": "适配 Claude CLI 接口"
          }
        ]
      },
      "classes": {
        "highlightClasses": ["LLMGrouper", "ClaudeCodeAdapter"],
        "annotateClasses": [
          {
            "className": "LLMGrouper",
            "stereotypes": ["<<Strategy>>"],
            "responsibility": "使用 LLM 进行语义分组"
          },
          {
            "className": "ClaudeCodeAdapter",
            "stereotypes": ["<<Adapter>>"],
            "responsibility": "封装 Claude CLI 调用"
          }
        ]
      },
      "annotations": {
        "enableComments": true,
        "highlightPatterns": true
      }
    },
    {
      "name": "method/types-module",
      "sources": ["./src/types"],
      "level": "method",
      "description": "Method-level detail for Types module",
      "metadata": {
        "title": "Types Module Method-Level Architecture",
        "subtitle": "类型定义模块详解",
        "purpose": "展示 ArchGuard 的核心类型定义",
        "primaryActors": ["开发者"]
      },
      "annotations": {
        "enableComments": true
      }
    },
    {
      "name": "method/utils-module",
      "sources": ["./src/utils"],
      "level": "method",
      "description": "Method-level detail for Utils module",
      "metadata": {
        "title": "Utils Module Method-Level Architecture",
        "subtitle": "工具模块详解",
        "purpose": "展示共享工具类和辅助函数",
        "primaryActors": ["开发者"]
      },
      "annotations": {
        "enableComments": true
      }
    }
  ]
}
